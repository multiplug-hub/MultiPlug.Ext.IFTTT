@model MultiPlug.Base.Http.EdgeApp


<section class="row-fluid">

    <div class="row-fluid">
        <div class="box">
            <div class="span3">
                <a href="#"><img alt="IFTTT Logo" src="@Raw(Model.Context.Paths.Assets)images/ifttt.png"></a>
            </div>
            <div class="span6">
                <p style="font-size:22.75px; padding-top:10px; text-align: center;">Timers</p>
            </div>
            <div class="span3">
            </div>
        </div>
    </div>

@Include("MultiPlug.Ext.IFTTT.IFTTTNavigation")

    <div class="row-fluid">
        <div class="box">
            <div class="well">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Event ID</th>
                            <th>Description</th>
                            <th>Interval</th>
                            <th>Enabled</th>
                            <th>Auto Reset</th>
                            <th>Running</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var Timer in @Model.Extension.Model.TimerComponents)
                        {
                            <tr>
                                <td><a href="@Raw(Model.Context.Paths.Home)timers/timer/?id=@Timer.Guid">@Timer.ElapsedEvent.Id</a></td>
                                <td><a href="@Raw(Model.Context.Paths.Home)timers/timer/?id=@Timer.Guid">@Timer.ElapsedEvent.Description</a></td>
                                <td><a href="@Raw(Model.Context.Paths.Home)timers/timer/?id=@Timer.Guid">@Timer.Interval</a></td>
                                <td>
                                    @if (Timer.Enabled)
                                    { <text>
                                    <i class="icon-ok"></i> </text> }
                                    else
                                    { <text>
                                    <i class="icon-remove"></i> </text> }
                                </td>
                                <td>
                                    @if (Timer.AutoReset)
                                    { <text>
                                    <i class="icon-ok"></i> </text> }
                                    else
                                    { <text>
                                    <i class="icon-remove"></i> </text> }
                                </td>
                                <td>
                                    @if (Timer.Running)
                                    { <text>
                                    <i class="icon-ok"></i> </text> }
                                    else
                                    { <text>
                                    <i class="icon-remove"></i> </text> }
                                </td>

                                <td>
                                    <div class="btn-group">
                                        <a class="btn btn-blue" href="@Raw(Model.Context.Paths.Home)timers/timer/?id=@Timer.Guid"><i class="icon-edit"></i></a>
                                        <a class="btn btn-red delete-timer" href="@Raw(Model.Context.Paths.Home)timers/timer/delete/?id=@Timer.Guid"><i class="icon-trash"></i></a>
                                    </div>
                                </td>
                            </tr>
                        }
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td><a class="btn btn-green" href="@Raw(Model.Context.Paths.Home)timers/timer/?id="><i class="icon-plus"></i></a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<script>
    function ApplyDelete(theSelector) {
        $(theSelector).on('click', '.delete-timer', function (event) {
            event.preventDefault();
            var closesttr = $(this).closest("tr");
            $.ajax({
                type: "POST",
                url: $(this).attr('href'),
                success: function () {
                    closesttr.remove();
                }
            });
        });
    }

    ApplyDelete(document);
</script>
